#!/usr/bin/env node
import { generateKeyPair, exportPKCS8, exportSPKI } from 'jose'
import { existsSync, mkdirSync, writeFileSync } from 'fs'

async function main () {
  if (!existsSync('./secrets')) mkdirSync('./secrets')

  const { privateKey, publicKey } = await generateKeyPair('ES256')
  if (!existsSync('./secrets/jwt.priv')) writeFileSync('./secrets/jwt.priv', await exportPKCS8(privateKey))
  if (!existsSync('./secrets/jwt.pub')) writeFileSync('./secrets/jwt.pub', await exportSPKI(publicKey))
}

main()
